#!/usr/bin/env python

import time
import requests
import urllib3
urllib3.disable_warnings(urllib3.exceptions.SecurityWarning)

char = "{}012345689abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPRSTUVWXYZ_!"
pairs = []


for i in range(0, len(char)):
  for j in range(0, len(char)):
    pairs.append( char[i] + char[j] )

flag = [None]*11

for i in range(0, len(pairs), 128):
  string = ""
  for k in range(0, 128):
    string += pairs[i+k]

  response = requests.post('http://localhost:5000', data={"sample":string})

  arr = response.text.split(' ')
  sample = arr[4]
  raw_flag = arr[9]

  for i in range(0, len(raw_flag)):
    for j in range(0, len(sample)):
      if raw_flag[i] == sample[j]:
        print "flag[" + str(i) + "] = " + string[j*2:j*2+2]
        flag[i] = string[j*2:j*2+2]


print ''.join(flag)
