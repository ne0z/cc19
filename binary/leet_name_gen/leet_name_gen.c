/*
 * Authors:
 * + Andrea Fioraldi <andreafioraldi@gmail.com>
 * + Pietro Borrello <pietro.borrello95@gmail.com>
 */

// gcc -no-pie -fno-stack-protector -z execstack leet_name_gen.c -o leet_name_gen

#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <ctype.h>

#define BANNER "\t\xe2\x94\xac  \xe2\x94\x8c\xe2\x94\x80\xe2\x94\x90\xe2\x94\x8c\xe2\x94\x80\xe2\x94\x90\xe2\x94\x8c\xe2\x94\xac\xe2\x94\x90  \xe2\x94\x8c\xe2\x94\x90\xe2\x94\x8c\xe2\x94\x8c\xe2\x94\x80\xe2\x94\x90\xe2\x94\x8c\xe2\x94\xac\xe2\x94\x90\xe2\x94\x8c\xe2\x94\x80\xe2\x94\x90         \n\t\xe2\x94\x82  \xe2\x94\x9c\xe2\x94\xa4 \xe2\x94\x9c\xe2\x94\xa4  \xe2\x94\x82   \xe2\x94\x82\xe2\x94\x82\xe2\x94\x82\xe2\x94\x9c\xe2\x94\x80\xe2\x94\xa4\xe2\x94\x82\xe2\x94\x82\xe2\x94\x82\xe2\x94\x9c\xe2\x94\xa4          \n\t\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x98\xe2\x94\x94\xe2\x94\x80\xe2\x94\x98\xe2\x94\x94\xe2\x94\x80\xe2\x94\x98 \xe2\x94\xb4   \xe2\x94\x98\xe2\x94\x94\xe2\x94\x98\xe2\x94\xb4 \xe2\x94\xb4\xe2\x94\xb4 \xe2\x94\xb4\xe2\x94\x94\xe2\x94\x80\xe2\x94\x98         \n\t        \xe2\x94\x8c\xe2\x94\x80\xe2\x94\x90\xe2\x94\x8c\xe2\x94\x80\xe2\x94\x90\xe2\x94\x8c\xe2\x94\x90\xe2\x94\x8c\xe2\x94\x8c\xe2\x94\x80\xe2\x94\x90\xe2\x94\xac\xe2\x94\x80\xe2\x94\x90\xe2\x94\x8c\xe2\x94\x80\xe2\x94\x90\xe2\x94\x8c\xe2\x94\xac\xe2\x94\x90\xe2\x94\x8c\xe2\x94\x80\xe2\x94\x90\xe2\x94\xac\xe2\x94\x80\xe2\x94\x90\n\t        \xe2\x94\x82 \xe2\x94\xac\xe2\x94\x9c\xe2\x94\xa4 \xe2\x94\x82\xe2\x94\x82\xe2\x94\x82\xe2\x94\x9c\xe2\x94\xa4 \xe2\x94\x9c\xe2\x94\xac\xe2\x94\x98\xe2\x94\x9c\xe2\x94\x80\xe2\x94\xa4 \xe2\x94\x82 \xe2\x94\x82 \xe2\x94\x82\xe2\x94\x9c\xe2\x94\xac\xe2\x94\x98\n\t        \xe2\x94\x94\xe2\x94\x80\xe2\x94\x98\xe2\x94\x94\xe2\x94\x80\xe2\x94\x98\xe2\x94\x98\xe2\x94\x94\xe2\x94\x98\xe2\x94\x94\xe2\x94\x80\xe2\x94\x98\xe2\x94\xb4\xe2\x94\x94\xe2\x94\x80\xe2\x94\xb4 \xe2\x94\xb4 \xe2\x94\xb4 \xe2\x94\x94\xe2\x94\x80\xe2\x94\x98\xe2\x94\xb4\xe2\x94\x94\xe2\x94\x80"


void generate_l33t_name(char* name)
{
    static char charset[] = "1234567890";
    size_t name_len = strlen(name);
    int char_sum = 0;
    
    int i;
    for(i = 0; i < name_len; ++i) {
        name[i] = tolower(name[i]);
        char_sum += name[i];
        
        switch(name[i]) {
        case 'a':
            name[i] = '4';
            break;
        case 'e':
            name[i] = '3';
            break;
        case 'i':
            name[i] = '1';
            break;
        case 'o':
            name[i] = '0';
            break;
        }
    }
    
    srand(char_sum);
    
    name[name_len] = '_';
    for (i = 1; i < 3; ++i) {            
        int key = rand() % (int)(sizeof(charset) -1);
        name[name_len +i] = charset[key];
    }
    name[name_len +i] = 0;
}

int main()
{
    char buffer[0x32];
    
    printf("\n\033[5;93m" BANNER "\033[0m\n\n\t [ License code %lu ]\n\n", (size_t)(void*)buffer);
    printf(" Enter your name and we will generate your hacker nickname using our complex machine learning algorithms\n");
    printf(" >> ");
    fflush(stdout);
    
    scanf("%s", buffer);
    generate_l33t_name(buffer);
    
    printf("\n\033[92m Congrats! Your l33t name is %s \033[0m\n\n", buffer);
    
    return 0;
}
